<!-- The Plate Mapper module -->
<!-- Plate list -->

{% extends logged_in_index.html %}
{% block head %}
{% from json import dumps %}
<script type="text/javascript" src="/static/js/labmin.js"></script>
<script type="text/javascript" src="/static/vendor/js/jquery.validate.min.js"></script>
<script type="text/javascript" src="/static/vendor/js/jquery.dataTables.min.js"></script>
<link rel="stylesheet" type="text/css" href="/static/vendor/css/jquery.dataTables.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
<style>
  p {
    font-weight: bold;
  }
  a {
    color: black;
  }
  button {
    padding: 5px 10px 5px 10px;
    text-decoration: none;
    font-size: 80%;
  }
  select {
    border: 1px solid black;
    padding: 5px 10px 5px 10px;
  }
  button.inline {
    height: 25px;
    width: 25px;
    padding: 2px 4px 2px 4px;
    border: 0;
    background-color: transparent;
    text-decoration: none;
    font-size: 80%;
  }
  button.inline:hover {
    background-color: dimgrey;
    color: white;
  }
  table {
    border-top: 1px solid black;
  }
  table.dataTable thead th {
    text-align: left;
    padding: 5px 10px 5px 10px;
  }
  tbody.list tr td {
    vertical-align: middle;
    padding: 5px 10px 5px 10px;
  }
  tbody.list tr:hover {
    background-color: lightgray;
  }
  tbody.list a:hover {
    color: darkblue;
    text-decoration: underline;
  }
  .dataTables_wrapper .dataTables_info {
    font-size: 90%;
  }
  .dataTables_wrapper .dataTables_filter {
    font-size: 90%;
  }
  .dataTables_wrapper .dataTables_length {
    font-size: 90%;
  }
  .dataTables_wrapper .dataTables_paginate {
    font-size: 90%;
  }
  .dataTables_wrapper .dataTables_paginate .paginate_button {
    padding: 4px 8px 4px 8px;
    text-decoration: none;
      /* padding : 0px;
      margin-left: 0px;
      display: inline;
      border: 0px; */
  }
  .dataTables_wrapper .dataTables_paginate .paginate_button:hover {
      /* border: 0px; */
  }
</style>
<script type="text/javascript">
  $(document).ready(function(){
    // var plates = {#plates#};
    $("#btnNew").click(function(){
        // alert("button");
        alert(this.innerHTML);
        alert($(this).text());
    });
    $('#plate_list').DataTable({
      scrollY: 450,
      scrollCollapse: true,
      pageLength: 50
    });
    $('#plate_list tbody').on('click', 'tr', function(){
        $(this).toggleClass('selected');
    });
  });
  window.onload = function() {
    // items=items, pageno=pageno, total=total, plates=plates
  }
</script>
{% end %}

{% block content %}
<h3 id="page_title">{{target[0].upper() + target[1:]}} Plate List</h3>
<p>
  <!--span style="float:right"><button id="btnNew">Create new plate</button></span-->
  <button id="btnNew"><i class="fa fa-plus"></i> Create new</button>
  <button id="btnDel"><i class="fa fa-remove"></i> Delete selected</button>
  <button id="btnEdit"><i class="fa fa-edit"></i> Batch-edit selected</button>
  <button id="btnDNA"><i class="fa fa-flask"></i> Convert to DNA plate</button>
  <button id="btnEdit"><i class="fa fa-download"></i> Export list</button>
</p>

<table id="plate_list">
  <thead>
    <tr>
      <th width="50px">ID</th>
      <th width="225px">Name</th>
      <th width="75px">Type</th>
      <th width="50px">Filled</th>
      <th width="50px">Study</th>
      <th width="75px">Person</th>
      <th width="75px">Date</th>
      <th width="100px">Actions</th>
    </tr>
  </thead>
  <tbody class="list">
    {% for plate in plates %}
    <tr>
      <td>{{plate['id']}}</td>
      <td><a href="/pm_plate_map/?target=sample&id={{plate['id']}}">{{plate['name']}}</a></td>
      <td title="{{plate['type'][1]}}">{{plate['type'][0]}}</td>
      <td>{{plate['count']}}
        <span style="font-size:80%">
          {% set x = plate['study'][0] / float(plate['type'][1]) %}
          {% if x == 1 %}
          <i class="fa fa-battery-full"></i>
          {% elif x >= 0.667 %}
          <i class="fa fa-battery-three-quarters"></i>
          {% elif x > 0.333 %}
          <i class="fa fa-battery-half"></i>
          {% elif x > 0 %}
          <i class="fa fa-battery-quarter"></i>
          {% else %}
          <i class="fa fa-battery-empty"></i>
          {% end %}
      </span></td>
      <td title="{{plate['study'][3]}}">{{plate['study'][1]}}</td>
      <td>{{plate['person'] or "-"}}</td>
      <td>{{plate['date'] or "-"}}</td>
      <td style="padding:2px;">
        <button class="inline" title="View/edit plate properties" onclick="location.href='/pm_plate_map/?target=sample&id={{plate['id']}}';"><i class="fa fa-edit"></i></button>
        <button class="inline" title="View/edit plate layout"><i class="fa fa-table"></i></button>
        <button class="inline" title="Delete plate"><i class="fa fa-remove"></i></button>
      </td>
    </tr>
    {% end %}
  </tbody>
</table>
<hr>

<form method="post" action="/pm_plate_list/" name="migrate_form" id="migrate_form">
  <input type="hidden" name="action" value="migrate">
  <p>Migrate data: <input type="submit"></p>
</form>
{% end %}
